\documentclass[tikz, border=0.5]{standalone}\n\n\usepackage{tikz}\n\usepackage{amsmath}\n\usepackage{amssymb}\n\usepackage{fmtcount}% http://ctan.org/pkg/fmtcount\n\usetikzlibrary{calc, patterns, intersections}\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n% note, \n%	0 - is an empty space; left uncolored\n%	1 - is an other agent; filled with black\n%	2 - is an edge; cross-hatched\n%	3 - is a do not care location\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n\begin{document}\n\n\t% model parameters\n\n\t\pgfmathtruncatemacro{\memory}{3}\n\t\pgfmathtruncatemacro{\visibility}{1}\n\t\pgfmathsetmacro{\maxtablelength}{8}\n\n\t% calculate the sizes of the neighborhood\n\t\newcommand{\GetNeighborhoodSizes}[1]{%%\n\t\t\xdef\toleft{0}\n\t\t\xdef\toright{0}\n\t\t\xdef\toup{0}\n\t\t\xdef\todown{0}\n\n\t\t\pgfmathtruncatemacro{\tableSize}{2 * \visibility + 1}\n\t\t\foreach \columnoffset/\rowoffset[count=\i] in #1 {%%\n\t\t\t\ifnum\columnoffset<\toleft%\n\t\t\t\xdef\toleft{\columnoffset}%\n\t\t\t\fi%\n\t\t\t\ifnum\columnoffset>\toright%\n\t\t\t\xdef\toright{\columnoffset}%\n\t\t\t\fi%\n\t\t\t\ifnum\rowoffset<\todown%\n\t\t\t\xdef\todown{\rowoffset}%\n\t\t\t\fi%\n\t\t\t\ifnum\rowoffset>\toup%\n\t\t\t\xdef\toup{\rowoffset}%\n\t\t\t\fi%\n\t\t\t\coordinate (anchor_\i) at (\columnoffset, \rowoffset);\n\t\t}\n\n\t\t\xdef\xbase{\toleft}\n\t\t\xdef\ybase{\todown}\n\t\t\pgfmathtruncatemacro{\pxsize}{\toright - \toleft + 1}\n\t\t\xdef\xsize{\pxsize}\n\t\t\pgfmathtruncatemacro{\pysize}{\toup - \todown + 1}\n\t\t\xdef\ysize{\pysize}\n\n\t}\n\n\t\newcommand*{\ExtractCoordinate}[1]{\path[overlay] (#1); \pgfgetlastxy{\XCoord}{\YCoord}}%\n\n\t% draw this neighborhood\n\t\newcommand{\DrawNeighborhood}[1]{%%\n\t\t\begin{scope}[scale=\scalefactor]\n\t\t\t\begin{scope}[shift={(-\\xbase, -\\ybase)}]\n\t\t\t\t\draw[fill=black] (0.5, 0.5) circle (3pt);\n\t\t\t\t\draw (0, 0) rectangle (1,1);\n\n\t\t\t\t\foreach \value[count=\i] in #1 {%%\n\t\t\t\t\t\ExtractCoordinate{anchor_\i}\n\t\t\t\t\t\begin{scope}[shift={(\XCoord, \YCoord)}]\n\t\t\t\t\t\t\ifnum\value=0%\n\t\t\t\t\t\t\t\draw (0, 0) rectangle (1, 1);\n\t\t\t\t\t\t\fi%\n\t\t\t\t\t\t\ifnum\value=1%\n\t\t\t\t\t\t\t\draw[fill=black!70] (0, 0) rectangle (1, 1);\n\t\t\t\t\t\t\fi%\n\t\t\t\t\t\t\ifnum\value=2%\n\t\t\t\t\t\t\t\draw[pattern=north west lines] (0, 0) rectangle (1, 1);\n\t\t\t\t\t\t\fi%\n\t\t\t\t\t\t\ifnum\value=3%\n\t\t\t\t\t\t\t\begin{scope}[opacity=0.4]\n\t\t\t\t\t\t\t\t\draw (0, 0) rectangle (1, 1);\n\t\t\t\t\t\t\t\t\node at (0.5, 0.5) {\bf X};\n\t\t\t\t\t\t\t\end{scope}\n\t\t\t\t\t\t\fi%\n\t\t\t\t\t\end{scope}\n\t\t\t\t}\n\t\t\t\end{scope}\n\t\t\end{scope}\n\t}\n\n\t% drawing parameters\n\t\pgfmathsetmacro{\scalefactor}{0.4}\n\t\pgfmathsetmacro{\tiklabelxoffset}{0.5}\n\t\pgfmathsetmacro{\tiklabelyoffset}{0.5}\n\n\t\begin{tikzpicture}\n\t\t\newcommand{\neighborsCoordinates}{%%\n\t\t\t0/-1\n\t\t\t0/1\n\t\t\t, \n\t\t\t1/0\n\t\t\t, -1/0\n\t\t}\n\t\t\newcommand{\neighbors}{}\n\t\t\GetNeighborhoodSizes{\neighborsCoordinates}\n\n\t\t\renewcommand{\neighbors}{%%\n\t\t\t0\n\t\t}\n\t\t\DrawNeighborhood{\neighbors}\n\t\end{tikzpicture}\n\end{document}\n