\documentclass{standalone}

\usepackage{silence}
%Disable all warnings issued by latex starting with "You have..."
\WarningFilter{latex}{You have requested package}
\usepackage{"C:/Users/dmitry.ra/Desktop/Studies/Articles/PhD/Latex\space Technical/userdefinitions.v003"}

\begin{document}
	\begin{tikzpicture}
		
		% define constants
		\pgfmathsetmacro{\lengthlabelline}{0.8}
		\pgfmathsetmacro{\labelxoffset}{0.5}
		\pgfmathsetmacro{\labelyoffset}{0.1}
		\pgfmathsetmacro{\tiklabelxoffset}{0.5}
		\pgfmathsetmacro{\tiklabelyoffset}{0.3}
		\pgfmathsetmacro{\tiklabelyoffset}{0.3}
		\pgfmathsetmacro{\valuexoffset}{0.5}
		\pgfmathsetmacro{\valueyoffset}{0.5}
		\pgfmathsetmacro{\xsize}{4}
		\pgfmathsetmacro{\ysize}{4}
		
		
		% common code
		\coordinate(left_upper_corner) at (0, \ysize);
		\draw (0, 0) grid (\xsize, \ysize);
		
		\draw (left_upper_corner)-- ++(135:\lengthlabelline);
		\node[rotate = -45, scale = 0.5] (input_label) at ($(left_upper_corner) + (135:\labelxoffset) + (45:\labelyoffset)$) {input};
		\node[rotate = -45, scale = 0.5] (input_label) at ($(left_upper_corner) + (135:\labelxoffset) + (180 + 45:\labelyoffset)$) {memory};
		
		\foreach \direction[count=\i] in { N, E, S, W }
		{
			\node(input_\direction) at (\i - 1 + \tiklabelxoffset, \ysize + \tiklabelyoffset) {\direction};
		}
		
		\foreach \memory in { 0, 1, 2, 3}
		{
			\pgfmathtruncatemacro{\memvalue}{\ysize - \memory - 1}
			\node (memory_\memory) at (0 - \tiklabelyoffset, \memory + \tiklabelxoffset) {\memvalue};
		}
		
		% hatch columns
		\foreach \column in {2, 3}
		{
			\draw[pattern = north west lines, pattern color = black!50!white] (\column, 0) rectangle ({\column + 1 }, \ysize);
		}
		
		% set cell values
		\node (node_00) at (0 + \valuexoffset, 3 + \valueyoffset) {0, N};
		\node (node_10) at (1 + \valuexoffset, 3 + \valueyoffset) {1, $\emptyset$};
		\node (node_01) at (0 + \valuexoffset, 2 + \valueyoffset) {3, N};
		\node (node_11) at (1 + \valuexoffset, 2 + \valueyoffset) {2, $\emptyset$};
		\node (node_02) at (0 + \valuexoffset, 1 + \valueyoffset) {3, N};
		\node (node_12) at (1 + \valuexoffset, 1 + \valueyoffset) {3, E};
		\node (node_03) at (0 + \valuexoffset, 0 + \valueyoffset) {3, $\emptyset$};
		
		% set final state
		\pgfmathsetmacro{\slightoffset}{0.05}
		\draw[rounded corners] (0 + \slightoffset, 2 + \slightoffset) rectangle (1 - \slightoffset, 3 - \slightoffset);
		\draw[rounded corners] (0 + \slightoffset, 1 + \slightoffset) rectangle (1 - \slightoffset, 2 - \slightoffset);
		
		% hatch error cells
		\foreach \x/\y in {2/3, 3/3, 2/2, 3/2, 2/1, 3/1, 1/0, 2/0, 3/0}
		{
			\draw[pattern = north west lines, pattern color = black!50!white] (\x, \y) rectangle ({\x+1}, {\y+1});
		}
		
		% hatch error cells
		\foreach \x/\y in {0/0}
		{
			\draw[pattern = north west lines, pattern color = blue!50!white] (\x, \y) rectangle ({\x+1}, {\y+1});
		}
	\end{tikzpicture}
\end{document}
